---
import { getLangFromUrl, useTranslations } from '../i18n/utils'
import { aboutData, skillsData, experienceData, projectsData } from '../i18n/data'
import { Icon } from 'astro-icon/components'
import profilePic from '@/assets/Profile.jpg'

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)

const about = aboutData[lang]
const skills = skillsData[lang]
const experiences = experienceData[lang]
const projects = projectsData[lang]

// Datos de contacto
const contact = {
  email: 'ricardosanjurg@gmail.com',
  phone: '+507 6820-2226',
  location: 'Panamá, Panamá',
  linkedin: 'linkedin.com/in/ricardo-amado-sanjur-gomez-61067822b',
  github: 'github.com/Ricky06202',
  website: 'rsanjur.com'
}
---

<div class="max-w-[850px] mx-auto bg-white text-slate-900 p-6 sm:p-8 md:p-12 shadow-2xl print:shadow-none print:p-0 font-sans leading-relaxed overflow-hidden sm:overflow-visible rounded-none sm:rounded-xl print:rounded-none">
  <!-- Botón de Impresión (Solo pantalla) -->
  <div class="flex justify-end mb-6 sm:mb-8 print:hidden">
    <button 
      onclick="window.print()" 
      class="fixed bottom-6 right-6 z-50 sm:static flex items-center gap-2 px-5 py-5 sm:px-6 sm:py-3 bg-sky-600 text-white font-bold rounded-full sm:rounded-lg hover:bg-sky-700 transition-all shadow-2xl shadow-sky-600/40 sm:shadow-lg sm:shadow-sky-600/20 active:scale-95"
      aria-label={lang === 'es' ? 'Imprimir CV' : 'Print CV'}
    >
      <Icon name="lucide:printer" class="size-6 sm:size-5" />
      <span class="hidden sm:inline">{lang === 'es' ? 'Imprimir / Guardar PDF' : lang === 'fr' ? 'Imprimer / Enregistrer PDF' : 'Print / Save PDF'}</span>
    </button>
  </div>

  <!-- Header -->
  <header class="cv-header border-b-4 border-sky-600 pb-6 mb-8">
    <div class="flex flex-col sm:flex-row items-center sm:items-start gap-4 sm:gap-8 mb-6 text-center sm:text-left">
      <!-- Foto de Perfil -->
      <div class="shrink-0">
        <img
          src={profilePic.src}
          alt="Ricardo Sanjur"
          class="size-24 sm:size-28 rounded-2xl object-cover border-2 border-sky-600/20 shadow-sm"
        />
      </div>
      
      <!-- Nombre y Rol -->
      <div class="flex-1">
        <h1 class="text-3xl sm:text-4xl md:text-5xl font-black tracking-tighter text-slate-900 uppercase mb-2 break-words">Ricardo Sanjur</h1>
        <p class="text-lg sm:text-xl font-bold text-sky-600 uppercase tracking-[0.15em] sm:tracking-[0.2em]">{t('hero.role')}</p>
      </div>
    </div>
    
    <!-- Info de Contacto -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-3 gap-x-4 text-[11px] sm:text-[12px] font-bold text-slate-600 border-t border-slate-100 pt-6">
      <div class="flex items-center gap-2">
        <Icon name="lucide:mail" class="size-4 text-sky-600" />
        {contact.email}
      </div>
      <div class="flex items-center gap-2">
        <Icon name="lucide:phone" class="size-4 text-sky-600" />
        {contact.phone}
      </div>
      <div class="flex items-center gap-2">
        <Icon name="lucide:map-pin" class="size-4 text-sky-600" />
        {contact.location}
      </div>
      <div class="flex items-center gap-2">
        <Icon name="lucide:globe" class="size-4 text-sky-600" />
        {contact.website}
      </div>
      <div class="flex items-center gap-2">
        <Icon name="lucide:linkedin" class="size-4 text-sky-600" />
        {contact.linkedin}
      </div>
      <div class="flex items-center gap-2">
        <Icon name="lucide:github" class="size-4 text-sky-600" />
        {contact.github}
      </div>
    </div>
  </header>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
    <!-- Columna Izquierda (Main) -->
    <div class="md:col-span-2 space-y-10">
      <!-- Resumen -->
      <section>
        <h2 class="text-lg font-black uppercase tracking-widest text-slate-900 mb-4 flex items-center gap-2">
          <span class="w-8 h-1 bg-sky-600"></span>
          {t('about.title')}
        </h2>
        <p class="text-slate-700 text-sm leading-relaxed">
          {about}
        </p>
      </section>

      <!-- Experiencia -->
      <section>
        <h2 class="text-lg font-black uppercase tracking-widest text-slate-900 mb-6 flex items-center gap-2">
          <span class="w-8 h-1 bg-sky-600"></span>
          {t('experience.title')}
        </h2>
        <div class="space-y-8">
          {experiences.map((exp) => (
            <div>
              <div class="flex justify-between items-start mb-1">
                <h3 class="font-bold text-slate-900">{exp.company}</h3>
                <span class="text-xs font-bold text-sky-600 uppercase">{exp.period}</span>
              </div>
              <p class="text-xs font-black text-slate-500 uppercase tracking-wider mb-2">{exp.role}</p>
              <p class="text-sm text-slate-600 leading-relaxed">
                {exp.description}
              </p>
            </div>
          ))}
        </div>
      </section>

      <!-- Proyectos Destacados -->
      <section>
        <h2 class="text-lg font-black uppercase tracking-widest text-slate-900 mb-6 flex items-center gap-2">
          <span class="w-8 h-1 bg-sky-600"></span>
          {t('projects.title')}
        </h2>
        <div class="grid grid-cols-1 gap-6">
          {projects.slice(0, 3).map((project) => (
            <div>
              <h3 class="font-bold text-slate-900 text-sm mb-1">{project.title}</h3>
              <p class="text-[10px] font-bold text-sky-600 uppercase mb-2">{project.role}</p>
              <p class="text-xs text-slate-600 mb-2">{project.description}</p>
              <div class="flex flex-wrap gap-2">
                {project.technologies.slice(0, 6).map((tech) => (
                  <span class="text-[9px] font-bold px-2 py-0.5 bg-slate-100 text-slate-600 rounded">
                    {tech}
                  </span>
                ))}
              </div>
            </div>
          ))}
        </div>
      </section>
    </div>

    <!-- Columna Derecha (Side) -->
    <div class="space-y-10">
      <!-- Habilidades -->
      <section>
        <h2 class="text-lg font-black uppercase tracking-widest text-slate-900 mb-6 flex items-center gap-2">
          <span class="w-8 h-1 bg-sky-600"></span>
          {lang === 'es' ? 'Habilidades' : lang === 'fr' ? 'Compétences' : 'Skills'}
        </h2>
        <div class="space-y-6">
          {Object.entries(skills).map(([category, data]) => (
            <div>
              <h3 class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-3">{category}</h3>
              <div class="flex flex-wrap gap-2">
                {(data as any).items.map((item: string) => (
                  <span class="text-xs font-bold text-slate-700">
                    • {item}
                  </span>
                ))}
              </div>
            </div>
          ))}
        </div>
      </section>

      <!-- Educación -->
      <section>
        <h2 class="text-lg font-black uppercase tracking-widest text-slate-900 mb-6 flex items-center gap-2">
          <span class="w-8 h-1 bg-sky-600"></span>
          {t('education.title')}
        </h2>
        <div class="space-y-4">
          <div>
            <h3 class="font-bold text-slate-900 text-sm">Universidad Tecnológica de Panamá</h3>
            <p class="text-xs text-slate-600 mt-1">{t('education.degree')}</p>
            <p class="text-[10px] font-bold text-sky-600 mt-1 uppercase">{t('education.status')}</p>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- Footer del CV -->
  <footer class="cv-footer mt-12 pt-8 border-t border-slate-100 text-center">
    <p class="text-[10px] text-slate-400 font-medium uppercase tracking-widest">
      {lang === 'es' ? 'Generado dinámicamente desde' : lang === 'fr' ? 'Généré dynamiquement à partir de' : 'Dynamically generated from'} rsanjur.com — 2026
    </p>
  </footer>
</div>

<style>
  @media print {
    body {
      background: white !important;
    }
    .shadow-2xl {
      box-shadow: none !important;
    }
    @page {
      margin: 1cm;
    }
  }
</style>
